create view [dbo].[csvReport] as (
SELECT dbo.Restaurant.Name AS RestaurantName,
COUNT(dbo.RestaurantMenuCustomer.Id) AS NumberOfOrderedCustomer,
SUM(dbo.RestaurantMenu.PriceInNis) AS ProfitInNis,
SUM(dbo.RestaurantMenu.PriceInUsd) AS ProfitInUsd, 
                  MAX(dbo.RestaurantMenu.MealName) AS TheBestSellingMeal,
				  MAX(dbo.Customer.FirstName) AS MostPurchasedCustomer
	FROM     dbo.Customer INNER JOIN
                  dbo.RestaurantMenu ON dbo.Customer.Id = dbo.RestaurantMenu.Id INNER JOIN
                
        dbo.RestaurantMenuCustomer ON dbo.RestaurantMenuCustomer.CustomerId = dbo.Customer.Id INNER JOIN
		   dbo.Restaurant ON dbo.Restaurant.Id = dbo.RestaurantMenu.Id
	GROUP BY dbo.Restaurant.Name, dbo.RestaurantMenu.MealName, dbo.Customer.FirstName
);
